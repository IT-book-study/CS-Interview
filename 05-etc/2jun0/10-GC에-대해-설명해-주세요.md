# 10. GC에 대해 설명해 주세요.

- Garbage Collection은 더 이상 사용되지 않는 메모리를 해제하는 역할을 합니다.

## 파이썬에서의 GC

- 파이썬에서는 reference counting과 cyclic garbage collector를 통해 GC를 구현합니다.

## Reference Counting

- 레퍼런스 카운팅은 객체가 참조되었을 때 1씩 증가시키고, 참조가 없어졌을 때 1씩 감소시킵니다.
- 카운터가 0이 되면 객체가 더 이상 사용되지 않는다는 것으로 판단하고 메모리에서 해제합니다.

## 순환 참조

- 레퍼런스 카운팅 방법은 순환 참조 상황에 취약한 단점이 있습니다.
- 순환 참조는 객체가 자신 객체를 참조하거나, 여러 객체들이 서로 참조하고 있을때 발생합니다.
- 사용하지 않아도 참조 카운트가 0으로 줄어들지 않는 현상이 일어나 메모리를 계속 차지하게 됩니다.

## Cyclic Garbage Collector

- Cyclic Garbage Collector(이하 가비지 컬렉터)는 객체들을 3개의 세대로 나눠서 관리합니다.
  - 세대는 0세대, 1세대, 2세대로 구분되는데 0세대는 최근에 생성된 객체이고 뒤로 갈 수록 오래된 객체입니다.
- 가비지 컬렉터는 0세대 일수록 더 자주 가비지 컬렉션을 합니다.
  - 각 세대 별로 임계값이 있는데, 0세대 객체가 메모리에 할당된 수를 기준으로 가비지 컬렉션이 일어납니다.
  - (threshold 0, threshold 1, threshold 2이 있으면, 0세대 객체가 threshold 0이상으로 할당될때 발생)
  - (이후 threshold 1, threshold 2는 이전 세대의 가비지 컬렉션 발생 수를 기준으로 발생)

## 순환 참조 감지

- 순환 참조는 컨테이너 객체(tuple, list, set, dict, class)에 의해서만 발생합니다.
  - 때문에 가비지 컬렉터는 순환 참조를 확인하기 위해서 컨테이너 객체만 추적합니다.
- 순환 참조를 찾는 과정은 아래와 같습니다.
  - 객체의 gc_refs 필드를 레퍼런스 카운트와 같게 설정합니다.
  - 객체에서 참조하는 다른 **컨테이너 객체**의 gc_refs필드를 감소시킵니다.
  - 객체의 gc_refs 필드가 0이라면, unreachable로 설정하고, gc_refs필드가 0이 아니라면 reachable로 설정합니다.
  - reachable인 객체들이 참조하는 객체들을 모두 reachable로 재설정합니다.
  - unreachable 객체의 메모리를 해제합니다.
